#include "unity.h"
#include "NFC_test.h"

void setUp(void)
{
}

void tearDown(void)
{
}

void test_NFC_test_unlockI2CSecurity_given_correct_password(void)
{
    uint8_t password[8] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    uint8_t correct[17] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    uint8_t result[17];

    unlockI2CSecurity(password,result);
    TEST_ASSERT_EQUAL_UINT8_ARRAY( correct,result,17);
}

void test_NFC_test_unlockI2CSecurity_given_wrong_password_expect_fail(void)
{
    uint8_t password[8] = {0x00,0x00,0x00,0x20,0x30,0x44,0x00,0x00};
    uint8_t correct[17] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x09,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    uint8_t result[17];

    unlockI2CSecurity(password,result);
    TEST_ASSERT_EQUAL_UINT8_ARRAY( correct,result,17);
}

void test_NFC_test_lockI2CSecurity(void)
{
    uint8_t correct[17] = {0x01,0x02,0x03,0x04,0x05,0x06,0x07,0x08,0x09,0x02,0x03,0x04,0x05,0x6,0x07,0x08,0x09};
    uint8_t result[17];

    lockI2CSecurity(result);
    TEST_ASSERT_EQUAL_UINT8_ARRAY( correct,result,17);
}

void test_NFC_test_changeI2CSecurity(void)
{
    uint8_t password[8] = {0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00};
    uint8_t newPass[8] = {0x07,0x07,0x07,0x07,0x08,0x08,0x08,0x08};
    uint8_t correct[17] = {0x07,0x07,0x07,0x07,0x08,0x08,0x08,0x08,0x07,0x07,0x07,0x07,0x07,0x08,0x08,0x08,0x08};
    uint8_t result[17];

    changeI2CSecurity(password,newPass,result);
    TEST_ASSERT_EQUAL_UINT8_ARRAY( correct,result,17);
}
